<Window x:Class="K_NECT.Views.Estudiante.RegistroHorasView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="K-NECT - Registro de Horas de Estudio" 
        Height="750" 
        Width="1300"
        WindowStyle="None"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        MouseDown="Window_MouseDown"
        Icon="/Resources/Images/LogoK-nect3.png">

    <Border Background="{StaticResource White}" 
            CornerRadius="15" 
            Margin="20"
            BorderBrush="{StaticResource GrayLight}"
            BorderThickness="1">

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- ===== PANEL IZQUIERDO - FORMULARIO ===== -->
            <Border Grid.Column="0" 
                    Background="{StaticResource PrimaryDark}"
                    CornerRadius="15,0,0,15">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <Border Grid.Row="0"
                            Background="{StaticResource PrimaryMedium}"
                            Padding="25,20"
                            CornerRadius="15,0,0,0">
                        <StackPanel>
                            <TextBlock Text="⏱️ REGISTRAR HORAS"
                                       Foreground="{StaticResource White}"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"/>
                            <TextBlock x:Name="txtEstudianteInfo"
                                       Text="Estudiante"
                                       Foreground="{StaticResource PrimaryLight}"
                                       FontSize="12"
                                       HorizontalAlignment="Center"
                                       Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Formulario -->
                    <ScrollViewer Grid.Row="1" 
                                 VerticalScrollBarVisibility="Auto"
                                 Margin="25,20,25,20">
                        <StackPanel>

                            <!-- Selector de Asignatura -->
                            <TextBlock Text="Asignatura *"
                                       Foreground="{StaticResource White}"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,8"/>

                            <ComboBox x:Name="cmbAsignaturas"
                                     FontSize="13"
                                     Height="40"
                                     VerticalContentAlignment="Center"
                                     Margin="0,0,0,20">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock>
                                            <Run Text="{Binding CodigoAsignatura}" FontWeight="Bold"/>
                                            <Run Text=" - "/>
                                            <Run Text="{Binding NombreAsignatura}"/>
                                        </TextBlock>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>

                            <!-- Fecha -->
                            <TextBlock Text="Fecha *"
                                       Foreground="{StaticResource White}"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,8"/>

                            <DatePicker x:Name="dpFecha"
                                FontSize="13"
                                Height="40"
                                VerticalContentAlignment="Center"
                                Margin="0,0,0,20"
                                SelectedDate="{x:Static sys:DateTime.Now}"
                                xmlns:sys="clr-namespace:System;assembly=mscorlib"/>


                            <!-- Horas de Estudio -->
                            <TextBlock Text="Horas de Estudio *"
                                       Foreground="{StaticResource White}"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,8"/>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <TextBox x:Name="txtHoras"
                                        Text="0"
                                        FontSize="13"
                                        Foreground="{StaticResource TextDark}"
                                        Width="60"
                                        Height="40"
                                        VerticalContentAlignment="Center"
                                        TextAlignment="Center"
                                        Margin="0,0,10,0"/>

                                <TextBlock Text="horas"
                                          Foreground="{StaticResource White}"
                                          FontSize="13"
                                          VerticalAlignment="Center"
                                          Margin="0,0,20,0"/>

                                <TextBox x:Name="txtMinutos"
                                        Text="0"
                                        FontSize="13"
                                        Foreground="{StaticResource TextDark}"
                                        Width="60"
                                        Height="40"
                                        VerticalContentAlignment="Center"
                                        TextAlignment="Center"
                                        Margin="0,0,10,0"/>

                                <TextBlock Text="minutos"
                                          Foreground="{StaticResource White}"
                                          FontSize="13"
                                          VerticalAlignment="Center"/>
                            </StackPanel>

                            <!-- Tema Estudiado -->
                            <TextBlock Text="Tema Estudiado *"
                                       Foreground="{StaticResource White}"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,8"/>

                            <TextBox x:Name="txtTema"
                                     FontSize="13"
                                     Foreground="{StaticResource TextDark}"
                                     Height="40"
                                     VerticalContentAlignment="Center"
                                     Padding="10,0"
                                     Margin="0,0,0,20"/>

                            <!-- Observaciones -->
                            <TextBlock Text="Observaciones (Opcional)"
                                       Foreground="{StaticResource White}"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,8"/>

                            <TextBox x:Name="txtObservaciones"
                                     FontSize="13"
                                     Foreground="{StaticResource TextDark}"
                                     Height="80"
                                     TextWrapping="Wrap"
                                     AcceptsReturn="True"
                                     VerticalScrollBarVisibility="Auto"
                                     Padding="10"/>

                        </StackPanel>
                    </ScrollViewer>

                    <!-- Botones -->
                    <StackPanel Grid.Row="2" Margin="25,0,25,25">
                        <Button x:Name="btnGuardar"
                                Content="💾 GUARDAR REGISTRO"
                                Background="{StaticResource SuccessDark}"
                                Foreground="{StaticResource White}"
                                FontSize="14"
                                FontWeight="Bold"
                                Padding="0,15"
                                Margin="0,0,0,10"
                                Cursor="Hand"
                                Click="BtnGuardar_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            CornerRadius="8"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>

                        <Button x:Name="btnLimpiar"
                                Content="🔄 LIMPIAR FORMULARIO"
                                Background="Transparent"
                                Foreground="{StaticResource White}"
                                BorderBrush="{StaticResource White}"
                                BorderThickness="2"
                                FontSize="13"
                                FontWeight="SemiBold"
                                Padding="0,12"
                                Cursor="Hand"
                                Click="BtnLimpiar_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="8"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ===== PANEL DERECHO - HISTORIAL ===== -->
            <Border Grid.Column="1" 
                    Background="{StaticResource White}"
                    CornerRadius="0,15,15,0">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <Border Grid.Row="0"
                            Background="{StaticResource PrimaryMedium}"
                            Padding="25,15"
                            CornerRadius="0,15,0,0">

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0"
                                    Content="← Volver"
                                    Background="Transparent"
                                    Foreground="{StaticResource White}"
                                    BorderThickness="0"
                                    FontSize="14"
                                    Cursor="Hand"
                                    Click="BtnVolver_Click"/>

                            <TextBlock Grid.Column="1"
                                       Text="📊 HISTORIAL DE ESTUDIO"
                                       Foreground="{StaticResource White}"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>

                            <Button Grid.Column="2"
                                    Content="×"
                                    Background="Transparent"
                                    Foreground="{StaticResource White}"
                                    BorderThickness="0"
                                    FontSize="24"
                                    FontWeight="Bold"
                                    Cursor="Hand"
                                    Click="BtnCerrar_Click"/>
                        </Grid>
                    </Border>

                    <!-- Estadísticas -->
                    <Border Grid.Row="1"
                            Background="{StaticResource PrimaryLight}"
                            Padding="25,20">

                        <UniformGrid Columns="3">
                            <Border Background="{StaticResource PrimaryDark}"
                                    CornerRadius="8"
                                    Padding="15,10"
                                    Margin="0,0,10,0">
                                <StackPanel>
                                    <TextBlock Text="TOTAL REGISTROS"
                                              Foreground="{StaticResource GrayLight}"
                                              FontSize="10"
                                              HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtTotalRegistros"
                                              Text="0"
                                              Foreground="{StaticResource White}"
                                              FontSize="24"
                                              FontWeight="Bold"
                                              HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <Border Background="{StaticResource SuccessDark}"
                                    CornerRadius="8"
                                    Padding="15,10"
                                    Margin="5,0,5,0">
                                <StackPanel>
                                    <TextBlock Text="HORAS TOTALES"
                                              Foreground="{StaticResource White}"
                                              FontSize="10"
                                              HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtTotalHoras"
                                              Text="0.0"
                                              Foreground="{StaticResource White}"
                                              FontSize="24"
                                              FontWeight="Bold"
                                              HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <Border Background="{StaticResource PrimaryMedium}"
                                    CornerRadius="8"
                                    Padding="15,10"
                                    Margin="10,0,0,0">
                                <StackPanel>
                                    <TextBlock Text="PROMEDIO/DÍA"
                                              Foreground="{StaticResource White}"
                                              FontSize="10"
                                              HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtPromedioHoras"
                                              Text="0.0"
                                              Foreground="{StaticResource White}"
                                              FontSize="24"
                                              FontWeight="Bold"
                                              HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </UniformGrid>
                    </Border>

                    <!-- Lista de Registros -->
                    <DataGrid Grid.Row="2"
                             x:Name="dgRegistros"
                             AutoGenerateColumns="False"
                             IsReadOnly="True"
                             GridLinesVisibility="None"
                             Background="{StaticResource White}"
                             RowBackground="{StaticResource White}"
                             AlternatingRowBackground="{StaticResource GrayLight}"
                             BorderBrush="{StaticResource GrayLight}"
                             BorderThickness="1"
                             CanUserResizeRows="False"
                             HeadersVisibility="Column"
                             SelectionMode="Single"
                             FontSize="13"
                             Margin="25,20,25,25">

                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="{StaticResource PrimaryDark}"/>
                                <Setter Property="Foreground" Value="{StaticResource White}"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                                <Setter Property="FontSize" Value="13"/>
                                <Setter Property="Padding" Value="15,12"/>
                                <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryLight}"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>

                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="Height" Value="45"/>
                            </Style>
                        </DataGrid.RowStyle>

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Fecha" 
                                              Binding="{Binding FechaFormateada}" 
                                              Width="100"/>

                            <DataGridTextColumn Header="Asignatura" 
                                              Binding="{Binding NombreAsignatura}" 
                                              Width="*"/>

                            <DataGridTextColumn Header="Horas" 
                                              Binding="{Binding HorasEstudio}" 
                                              Width="80"/>

                            <DataGridTextColumn Header="Tema" 
                                              Binding="{Binding TemaEstudiado}" 
                                              Width="*"/>

                            <DataGridTemplateColumn Header="Acciones" Width="120">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="🗑️"
                                                   Background="Transparent"
                                                   BorderThickness="0"
                                                   FontSize="16"
                                                   Cursor="Hand"
                                                   ToolTip="Eliminar"
                                                   Click="BtnEliminar_Click"
                                                   Tag="{Binding IdRegistro}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Mensaje sin registros -->
                    <StackPanel Grid.Row="2"
                               x:Name="pnlSinRegistros"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"
                               Visibility="Collapsed">
                        <TextBlock Text="📚"
                                  FontSize="48"
                                  HorizontalAlignment="Center"
                                  Margin="0,0,0,15"/>
                        <TextBlock Text="No tienes registros de estudio aún"
                                  Foreground="{StaticResource TextLight}"
                                  FontSize="16"
                                  HorizontalAlignment="Center"/>
                        <TextBlock Text="¡Comienza registrando tus horas!"
                                  Foreground="{StaticResource TextLight}"
                                  FontSize="13"
                                  HorizontalAlignment="Center"
                                  Margin="0,5,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>